{% extends 'core/base.html' %}

{% block title %}{{ object.display_name }}{% endblock %}

{% block main %}
<h1>{{ object.display_name }}'s profile</h1>

{% if object.avatar %}
  {% include 'widgets/crop_apply.html' with img_url=object.avatar.url crop=object.avatar_crop width='20rem' height='20rem' %}
{% else %}
  <section class='avatar-placeholder'>
    {% include 'snippets/user.svg' %}
  </section>
{% endif %}

{% if request.user == object %}
  <a href='{% url "profile_edit" %}'>edit profile</a>
{% else %}
  <a href='{% url "convo_detail" pk=object.pk %}'>view messages with this user</a>
  <p>
    In circles:
    <form method="post" action="{% url 'edit_circles' pk=object.pk %}">
      {% csrf_token %}
      {% for circle in in_circles %}
      <div class="circle-checkbox">
        <label>
            <input
                type="checkbox"
                name="circles"
                value="{{ circle.pk }}"
                {% if circle in in_circles %} checked {% endif %}
                
            >
            <div class="circle-widget">
                {% include 'widgets/circle.html' with circle=circle %}
            </div>
        </label>
    </div>
       
    
    {% empty %}
      <em>Not in any circles.</em>
    {% endfor %}
    <button type="submit">Save Changes</button>
    </form>
  </p>
  
{% endif %}

{% include 'widgets/post_list.html' with post_list=feed_for_user %}

{% endblock %}
